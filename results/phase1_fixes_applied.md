# Phase 1 Fixes Applied Report

**Run ID:** 20251220_080506
**Timestamp:** 2025-12-20 08:05:06
**Symbols:** MES, MGC
**Status:** FAILED

---

## Critical Fixes Applied

### Fix #1: Barrier Parameters Recalibrated

The barrier multipliers were empirically calibrated to achieve balanced class distributions.

| Horizon | Old k_up | Old k_down | New k_up | New k_down | New max_bars | Status |
|---------|----------|------------|----------|------------|--------------|--------|
| H1 | 0.25 | 0.25 | 0.25 | 0.25 | 5 | INACTIVE |
| H5 | 0.9 | 0.9 | 0.9 | 0.9 | 25 | Active |
| H20 | 2.0 | 2.0 | 2.0 | 2.0 | 100 | Active |

**Note:** H1 is marked INACTIVE due to transaction costs consuming the edge.

### Fix #2: Purge Bars Increased

Purge bars increased from 20 to 60 to prevent label leakage.

### Fix #3: Same-Bar Barrier Race Condition

When both barriers are hit on the same bar, the fix now uses price proximity logic
to determine which barrier was likely hit first.

### Fix #4: Feature Scaling Preparation

Feature scaling statistics computed and stored for consistent normalization during training.

---

## Label Distribution Comparison

### MES

| Horizon | Metric | Before | After | Change |
|---------|--------|--------|-------|--------|
| H1 | Long | 61.2% | 61.2% | +0.0% |
| H1 | Short | 38.4% | 38.4% | +0.0% |
| H1 | Neutral | 0.4% | 0.4% | +0.0% |
| H5 | Long | 50.3% | 50.3% | +0.0% |
| H5 | Short | 48.7% | 48.7% | +0.0% |
| H5 | Neutral | 1.0% | 1.0% | +0.0% |
| H20 | Long | 50.3% | 50.3% | +0.0% |
| H20 | Short | 47.8% | 47.8% | +0.0% |
| H20 | Neutral | 2.0% | 2.0% | +0.0% |

### MGC

| Horizon | Metric | Before | After | Change |
|---------|--------|--------|-------|--------|
| H1 | Long | 56.8% | 56.8% | +0.0% |
| H1 | Short | 43.1% | 43.1% | +0.0% |
| H1 | Neutral | 0.1% | 0.1% | +0.0% |
| H5 | Long | 50.1% | 50.1% | +0.0% |
| H5 | Short | 49.5% | 49.5% | +0.0% |
| H5 | Neutral | 0.3% | 0.3% | +0.0% |
| H20 | Long | 49.5% | 49.5% | +0.0% |
| H20 | Short | 49.0% | 49.0% | +0.0% |
| H20 | Neutral | 1.4% | 1.4% | +0.0% |

---

## Validation Results

- **Passed:** 4
- **Warnings:** 1
- **Failed:** 7

### Failed Validations

- **MES_H1_neutral_reduction**: Neutral: 0.4% -> 0.4%
- **MES_H1_long_short_balance**: Long ratio: 0.61 (target: 0.50 +/- 0.05)
- **MES_H5_neutral_reduction**: Neutral: 1.0% -> 1.0%
- **MES_H20_neutral_reduction**: Neutral: 2.0% -> 2.0%
- **MGC_H1_neutral_reduction**: Neutral: 0.1% -> 0.1%
- **MGC_H5_neutral_reduction**: Neutral: 0.3% -> 0.3%
- **MGC_H20_neutral_reduction**: Neutral: 1.4% -> 1.4%

### Warnings

- **MGC_H1_long_short_balance**: Long ratio: 0.57 (target: 0.50 +/- 0.05)

---

## Feature Scaling Statistics

| Scaler Type | Feature Count |
|-------------|---------------|
| standard | 45 |
| robust | 3 |
| log_transform | 12 |

---

## Issues

- 7 validation checks failed

## Warnings

No warnings.

---

*Generated by rerun_phase1_with_fixes.py on 2025-12-20 08:05:06*
